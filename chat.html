<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JobinKI Chat-Matching</title>
  <style>
    body {
      font-family: sans-serif;
      background: linear-gradient(to bottom, #320366, #3533cd);
      color: white;
      padding: 40px;
    }
    #chat {
      max-width: 600px;
      margin: auto;
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 10px;
    }
    .message {
      margin: 10px 0;
    }
    .user { text-align: right; }
    .ai { text-align: left; }
    input, button {
      padding: 10px;
      border-radius: 5px;
      border: none;
      margin-top: 10px;
    }
    button { background-color: #2c2abf; color: white; }
  </style>
</head>
<body>

<div id="chat">
  <div id="messages"></div>
  <input type="text" id="input" placeholder="Antwort eingeben..." />
  <button onclick="next()">Absenden</button>
</div>

<script>
  const questions = [
    "SchÃ¶n dass du hier bist. Was suchst du gerade â€“ neue Perspektiven oder ein passenderes Umfeld?",
    "Wie ist dein Name?",
    "Wann bist du geboren?",
    "Welche Sprachen sprichst du?",
    "Nach welchen Stellen dÃ¼rfen wir fÃ¼r dich suchen?",
    "Hast du eine Ausbildung abgeschlossen?",
    "Hast du Berufserfahrung hast du in dem Bereich?",
    "Welche Qualifikationen bringst du mit?",
    "Welche Erfahrungen hast du gesammelt, die nicht durch Zeugnisse oder Zertifikate nachweisbar sind, aber dir heute helfen deine StÃ¤rken einzusetzen?",
    "Wenn du dich heute frei entscheiden kÃ¶nntest, was wÃ¼rdest du gerne beruflich machen?",
    "Gab es berufliche Umwege, BrÃ¼che oder Neustarts in deinem Leben, die dich besonders geprÃ¤gt haben?",
    "Hast du dir neues Wissen oder FÃ¤higkeiten in den letzten Jahren selbst beigebracht?",
    "Hast du Interesse an einer beruflichen Neuorientierung?",
    "WÃ¼rdest du ein Praktikum in ErwÃ¤gung ziehen, wenn du ein Job findest der ausschliesslich deinen persÃ¶nlichen FÃ¤higkeiten entspricht?",
    "Welche Werte sind dir bei der Arbeit besonders wichtig?",
    "Wie wÃ¼rdest du dich eher einschÃ¤tzen? Introvertiert oder extrovertiert?",
    "Wie wÃ¼rdest du deinen Arbeitsstil beschreiben?",
    "Welches Abeitsumfeld bevorzugst du? BÃ¼ro, Hybrid, Remote?",
    "Wie sind deine Gehaltsvorstellungen?",
    "Wo siehst du dich in 5 Jahren? TrÃ¤ume groÃŸ, so kÃ¶nnen wir dich besser kennenlernen.",
    "Gibt es etwas das du uns gerne noch mitteilen mÃ¶chtest?",
    "Vielen Dank fÃ¼r deine Teilnahme. Wir suchen passende Jobs fÃ¼r dichâ€¦"
  ];

  const answers = [];
  let step = 0;

  function next() {
    const input = document.getElementById('input');
    const msgBox = document.getElementById('messages');

    if (input.value.trim() === "") return;

    // Benutzerantwort anzeigen
    const userMsg = document.createElement('div');
    userMsg.className = 'message user';
    userMsg.textContent = input.value;
    msgBox.appendChild(userMsg);
    answers.push(input.value);

    // Eingabe zurÃ¼cksetzen
    input.value = "";

    setTimeout(async () => {
      const aiMsg = document.createElement('div');
      aiMsg.className = 'message ai';

      if (step < questions.length - 1) {
        step++;
        aiMsg.textContent = questions[step];
        msgBox.appendChild(aiMsg);
        msgBox.scrollTop = msgBox.scrollHeight;
      } else {
        // ðŸ’¼ Jobs abrufen
        aiMsg.textContent = "Einen Moment, wir suchen passende Jobs fÃ¼r dich...";
        msgBox.appendChild(aiMsg);
        msgBox.scrollTop = msgBox.scrollHeight;

        try {
          const response = await fetch('/api/jobs', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query: answers[4], location: 'Rostock' })
          });

          const data = await response.json();

          aiMsg.innerHTML = "<strong>Hier sind passende Stellen fÃ¼r dich:</strong><ul>" +
            data.jobs.map(job => `<li>${job.title} â€“ ${job.location}</li>`).join('') +
            "</ul>";
        } catch (error) {
          aiMsg.textContent = "Leider konnten wir gerade keine Jobs abrufen.";
        }

        input.style.display = "none";
        document.querySelector("button").style.display = "none";
        msgBox.scrollTop = msgBox.scrollHeight;
      }
    }, 500);
  }

  // Startfrage anzeigen
  window.onload = () => {
    const msgBox = document.getElementById('messages');
    const aiMsg = document.createElement('div');
    aiMsg.className = 'message ai';
    aiMsg.textContent = questions[0];
    msgBox.appendChild(aiMsg);
  };
  
</script>

</body>

</html>
